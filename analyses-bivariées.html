<!DOCTYPE html>
<html lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapitre 4 Analyses bivariées | Analyser des données avec R</title>
<meta name="author" content="Pierre-Yves de Müllenheim">
<meta name="description" content="Réaliser une analyse bivariée désigne le fait d’étudier la relation qui peut exister entre deux variables. Dans ce chapitre, nous allons voir les procédures graphiques et calculatoires qui...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Chapitre 4 Analyses bivariées | Analyser des données avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/pydemull/Analyser-des-donnees-avec-R/analyses-bivariées.html">
<meta property="og:description" content="Réaliser une analyse bivariée désigne le fait d’étudier la relation qui peut exister entre deux variables. Dans ce chapitre, nous allons voir les procédures graphiques et calculatoires qui...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapitre 4 Analyses bivariées | Analyser des données avec R">
<meta name="twitter:description" content="Réaliser une analyse bivariée désigne le fait d’étudier la relation qui peut exister entre deux variables. Dans ce chapitre, nous allons voir les procédures graphiques et calculatoires qui...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/scrool.css" rel="stylesheet">
<!-- Code fom Dexter to custom bs4_book template: https://stackoverflow.com/questions/66128954/change-right-sidebar-header-in-bs4-book-bookdown --><script>
      $(function() {
          $("#toc h2").html("Dans ce chapitre");
      });
  </script><script>
      $(function() {
          $("#main-nav h2").html("Sommaire");
      });
  </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Analyser des données avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li class="book-part">Appropriation de R et RStudio</li>
<li><a class="" href="pr%C3%A9requis.html"><span class="header-section-number">1</span> Prérequis</a></li>
<li><a class="" href="importation-et-manipulation-dune-base-de-donn%C3%A9es.html"><span class="header-section-number">2</span> Importation et manipulation d’une base de données</a></li>
<li class="book-part">Analyses descriptives</li>
<li><a class="" href="analyses-univari%C3%A9es.html"><span class="header-section-number">3</span> Analyses univariées</a></li>
<li><a class="active" href="analyses-bivari%C3%A9es.html"><span class="header-section-number">4</span> Analyses bivariées</a></li>
<li><a class="" href="r%C3%A9gressions.html"><span class="header-section-number">5</span> Régressions</a></li>
<li class="book-part">Analyses inférentielles</li>
<li><a class="" href="pr%C3%A9requis-1.html"><span class="header-section-number">6</span> Prérequis</a></li>
<li><a class="" href="tests-statistiques-pour-des-variables-qualitatives.html"><span class="header-section-number">7</span> Tests statistiques pour des variables qualitatives</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/pydemull/Analyser-des-donnees-avec-R">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analyses-bivariées" class="section level1">
<h1>
<span class="header-section-number">Chapitre 4</span> Analyses bivariées<a class="anchor" aria-label="anchor" href="#analyses-bivari%C3%A9es"><i class="fas fa-link"></i></a>
</h1>
<p>Réaliser une analyse bivariée désigne le fait d’étudier la relation qui peut exister entre deux variables. Dans ce chapitre, nous allons voir les procédures graphiques et calculatoires qui permettent d’étudier et de quantifier le degré de relation pouvant exister entre deux variables dans les cas suivants : entre deux variables quantitatives, entre deux variables qualitatives, et entre une variable quantitative et une variable qualitative. Comme dans le chapitre précédent, l’objectif est ici d’explorer et de décrire les données et leurs relations à l’échelle d’un échantillon, sans pour autant chercher à déterminer l’incertitude qu’il peut exister dans les statistiques calculées en vue de les utiliser pour réaliser une inférence dans la population représentée.</p>
<div id="relation-entre-deux-variables-quantitatives" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Relation entre deux variables quantitatives<a class="anchor" aria-label="anchor" href="#relation-entre-deux-variables-quantitatives"><i class="fas fa-link"></i></a>
</h2>
<div id="étudier-graphiquement-la-relation" class="section level3">
<h3>
<span class="header-section-number">4.1.1</span> Étudier graphiquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-graphiquement-la-relation"><i class="fas fa-link"></i></a>
</h3>
<p>Comme dans le cadre d’analyses univariées, une bonne pratique, lorsqu’on étudie une relation bivariée, est de faire un graphique. Avec des variables quantitatives, il s’agit de montrer les valeurs d’une variable en fonction des valeurs de l’autre variable, chose que permet un simple nuage de points. Plusieurs types de relations peuvent alors être rencontrés, ces relations pouvant potentiellement s’apparenter à autant de fonctions mathématiques que l’on connaît. Parmi les plus connues, on a par exemple les relations linéaires, les relations logarithmiques, ou encore les relations quadratiques, qui sont illustrées sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:relationshipsIllustrations">4.1</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:relationshipsIllustrations"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/relationshipsIllustrations-1.png" alt="Différentes formes de relation entre deux variables quantitatives" width="100%"><p class="caption">
Figure 4.1: Différentes formes de relation entre deux variables quantitatives
</p>
</div>
<p>Avec R, pour obtenir un nuage de points à partir d’un jeu de données, il est possible d’utiliser la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> en l’associant à la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> du package <code>ggplot2</code>, comme dans l’exemple ci-dessous qui utilise le jeu de données <code>mtcars</code> (qui est intégré à R de base) et les variables <code>hp</code> (<em>gross horsepower</em>) et <code>mpg</code> (<em>miles/US gallon</em>). Dans cet exemple dont le résultat est montré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:scatterplot">4.2</a>, on peut voir que la relation semble globalement linéaire négative (voire curvilinéaire négative si l’on donne de l’importance au point isolé à droite du graphique).</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatterplot"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/scatterplot-1.png" alt="Nuage de points montrant les variables hp et mpg du jeu de données mtcars" width="90%"><p class="caption">
Figure 4.2: Nuage de points montrant les variables hp et mpg du jeu de données mtcars
</p>
</div>
</div>
<div id="étudier-numériquement-la-relation" class="section level3">
<h3>
<span class="header-section-number">4.1.2</span> Étudier numériquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-num%C3%A9riquement-la-relation"><i class="fas fa-link"></i></a>
</h3>
<p><em>Le coefficient de corrélation de Pearson</em></p>
<p>Lorsque la relation étudiée semble linéaire, l’étude numérique classique consiste à calculer le coefficient de corrélation de Pearson, noté <span class="math inline">\(r\)</span>, dont la valeur vise à renseigner dans quelle mesure le nuage de points représentant le lien entre les deux variables étudiées suit une droite. Avant de se lancer dans le calcul du coefficient de corrélation de Pearson pour étudier la relation entre une variable <span class="math inline">\(X\)</span> et une variable <span class="math inline">\(Y\)</span>, il peut donc être utile de compléter le nuage de points montré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:scatterplot">4.2</a> avec une droite d’équation de type <span class="math inline">\(Y = aX + b\)</span>. Cette équation serait la meilleure modélisation possible de la relation linéaire entre <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, de telle sorte que parmi l’infinité d’équations qui pourraient lier <span class="math inline">\(X\)</span> à <span class="math inline">\(Y\)</span>, c’est cette équation qui au total donnerait la plus petite erreur lorsque l’on voudrait prédire <span class="math inline">\(Y\)</span> à partir de <span class="math inline">\(X\)</span>. Si <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> sont liées de manière linéaire, alors le nuage des points relatifs aux deux variables devrait s’étaler le long de cette droite. Pour obtenir cette droite en plus du nuage de points, il est possible d’utiliser la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> du package <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatterplotLine"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/scatterplotLine-1.png" alt="Nuage de points avec droite de régression pour les variables hp et mpg du jeu de données mtcars" width="90%"><p class="caption">
Figure 4.3: Nuage de points avec droite de régression pour les variables hp et mpg du jeu de données mtcars
</p>
</div>
<p>Dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> qui a été utilisée dans l’exemple ci-dessus, on note que l’argument <code>formula</code> pourrait être considéré comme facultatif car il s’agit ici de la configuration par défaut de la fonction. En revanche, l’argument <code>method</code> doit être ici configuré avec <code>"lm"</code> (pour <em>linear model</em>) car ce n’est pas la méthode graphique configurée par défaut dans la fonction. Enfin, l’argument <code>se</code> permet de montrer ou non un intervalle de confiance autour de la droite de régression, ce qui n’a pas été activé ici (par défaut, l’argument <code>se</code> est configuré pour montrer cet intervalle de confiance). Dans l’exemple montré ci-dessus, la représentation graphique encourage fortement à penser que l’un des types de relations à envisager prioritairement dans l’étude des deux variables est la relation linéaire. Cette information rend pertinente l’utilisation du coefficient de corrélation de Pearson pour une étude numérique de la relation en question.</p>
<p>La valeur du coefficient de corrélation de Pearson peut aller de 1 (suggérant une relation linéaire positive parfaite) à -1 (suggérant une relation linéaire négative parfaite). Des valeurs proches de 0 suggèreraient une abscence de relation linéaire. La formule du coefficient de corrélation de Pearson (<span class="math inline">\(r\)</span>) pour un échantillon est la suivante :</p>
<p><span class="math display">\[r_{X,Y} =  {\frac{COV_{X,Y}}{\hat{\sigma}_{X} \hat{\sigma}_{Y}}} =  {\frac{\sum_{i=1}^{N} (X{i} - \overline{X}) (Y{i} - \overline{Y})}{N-1}} {\frac{1}{\hat{\sigma}_{X} \hat{\sigma}_{Y}}},\]</span></p>
<p><span class="math inline">\(COV\)</span> désignant la covariance entre les variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, <span class="math inline">\(X{i}\)</span> et <span class="math inline">\(Y{i}\)</span> les valeurs de <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span> pour une observation <span class="math inline">\(i\)</span>, <span class="math inline">\(\overline{X}\)</span> et <span class="math inline">\(\overline{Y}\)</span> les moyennes respectives des variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, <span class="math inline">\(N\)</span> le nombre d’observations, et <span class="math inline">\(\hat{\sigma}_{X}\)</span> et <span class="math inline">\(\hat{\sigma}_{Y}\)</span> les écarts-types respectifs des variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>. Cette formule indique que le coefficient de corrélation de Pearson s’obtient en divisant la covariance des deux variables étudiées par le produit de leurs écarts-types respectifs.</p>
<p>Le Tableau <a href="analyses-bivari%C3%A9es.html#tab:tablecov">4.1</a> montre les premières étapes du calcul de la covariance pour des couples de variables fictifs <span class="math inline">\((X1,Y1)\)</span>, <span class="math inline">\((X1,Y2)\)</span>, et <span class="math inline">\((X1,Y3)\)</span>. En particulier, la partie droite du tableau (de X1Y1 à X1Y3) montre le calcul du produit <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> pour les différents couples de variables et cela pour chaque ligne du jeu de données.</p>
<template id="8d29bfce-525b-4e49-ba66-55dae81c767e"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-5bad59ac{}.cl-5ba0e24e{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5ba0e262{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5ba0fc20{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5ba166b0{width:34pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166ba{width:47.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166bb{width:76.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166c4{width:36.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166ce{width:34pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166d8{width:76.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166d9{width:47.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166da{width:36.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166e2{width:34pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166ec{width:47.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166f6{width:76.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166f7{width:36.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba166f8{width:76.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16700{width:34pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16701{width:47.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16702{width:36.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba1670a{width:34pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16714{width:36.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16715{width:47.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba1671e{width:76.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba1671f{width:34pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16728{width:47.4pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16729{width:36.4pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5ba16732{width:76.2pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table class="cl-5bad59ac">
<caption class="Table Caption">
<p><span id="tab:tablecov">Tableau 4.1: </span>Étape intermédiaire pour le calcul de la covariance entre des variables X1 et Y1, Y2, et Y3</p>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<td class="cl-5ba1671f"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">X1</span></p></td>
<td class="cl-5ba1671f"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">Y1</span></p></td>
<td class="cl-5ba1671f"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">Y2</span></p></td>
<td class="cl-5ba16729"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">Y3</span></p></td>
<td class="cl-5ba16728"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">X1Y1</span></p></td>
<td class="cl-5ba16732"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">X1Y2</span></p></td>
<td class="cl-5ba16728"><p class="cl-5ba0fc20"><span class="cl-5ba0e24e">X1Y3</span></p></td>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
<td class="cl-5ba166c4"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">36</span></p></td>
<td class="cl-5ba166bb"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">40.285714</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-36</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba166ce"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">2</span></p></td>
<td class="cl-5ba166ce"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">2</span></p></td>
<td class="cl-5ba166ce"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">1</span></p></td>
<td class="cl-5ba166da"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-2</span></p></td>
<td class="cl-5ba166d9"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">16</span></p></td>
<td class="cl-5ba166d8"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">22.857143</span></p></td>
<td class="cl-5ba166d9"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-16</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">4</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">4</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">15</span></p></td>
<td class="cl-5ba166c4"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-4</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">4</span></p></td>
<td class="cl-5ba166bb"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-16.571429</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba166e2"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">6</span></p></td>
<td class="cl-5ba166e2"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">6</span></p></td>
<td class="cl-5ba166e2"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">5</span></p></td>
<td class="cl-5ba166f7"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-6</span></p></td>
<td class="cl-5ba166ec"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
<td class="cl-5ba166f6"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0.000000</span></p></td>
<td class="cl-5ba166ec"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">8</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">8</span></p></td>
<td class="cl-5ba166b0"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">11</span></p></td>
<td class="cl-5ba166c4"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-8</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">4</span></p></td>
<td class="cl-5ba166bb"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">8.571429</span></p></td>
<td class="cl-5ba166ba"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba16700"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">10</span></p></td>
<td class="cl-5ba16700"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">10</span></p></td>
<td class="cl-5ba16700"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">3</span></p></td>
<td class="cl-5ba16702"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-10</span></p></td>
<td class="cl-5ba16701"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">16</span></p></td>
<td class="cl-5ba166f8"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-14.857143</span></p></td>
<td class="cl-5ba16701"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-16</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5ba1670a"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">12</span></p></td>
<td class="cl-5ba1670a"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">12</span></p></td>
<td class="cl-5ba1670a"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">12</span></p></td>
<td class="cl-5ba16714"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-12</span></p></td>
<td class="cl-5ba16715"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">36</span></p></td>
<td class="cl-5ba1671e"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">31.714286</span></p></td>
<td class="cl-5ba16715"><p class="cl-5ba0fc20"><span class="cl-5ba0e262">-36</span></p></td>
</tr>
</tbody>
</table></div>
</div></template><div class="flextable-shadow-host" id="cf000b44-3306-4f6e-ad6a-5591b24aa5e3"></div>
<script>
var dest = document.getElementById("cf000b44-3306-4f6e-ad6a-5591b24aa5e3");
var template = document.getElementById("8d29bfce-525b-4e49-ba66-55dae81c767e");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><p>Ce que ce tableau montre, c’est que plus les deux variables étudiées évolueront de manière consistante dans des sens identiques comme avec <span class="math inline">\(X1\)</span> et <span class="math inline">\(Y1\)</span>, ou de manière consistante dans des sens opposés comme avec <span class="math inline">\(X1\)</span> et <span class="math inline">\(Y3\)</span>, plus les produits <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> donneront respectivement des grands scores positifs ou des grands scores négatifs, et moins les scores <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> à additionner pour le calcul de la covariance s’annuleront. En effet, avec une relation relativement linéaire et positive les scores seront plus systématiquement positifs, et avec une relation relativement linéaire et négative les scores seront plus systématiquement négatifs. Toutefois, lorsqu’on aura des variables qui n’évolueront pas de manière consistante dans le même sens ou dans un sens opposé comme avec <span class="math inline">\(X1\)</span> et <span class="math inline">\(Y2\)</span>, les scores positifs et négatifs liés aux calculs <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> auront tendance à s’annuler et donneront lieu à une somme des scores <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> diminuée, et donc à une covariance et à un coefficient de corrélation de Pearson tirés vers 0. Ces différents cas de figure et les calculs <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> correspondants sont illustrés sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:graphCov">4.4</a>. Sur cette figure, chaque carré correspond au calcul <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span>, le carré étant bleu lorsque le résultat du calcul est positif, et rouge lorsque le résultat est négatif. L’aire d’un carré illustre la grandeur du score issu du calcul. Sur les graphiques de gauche et de droite de la figure, on distingue une relation linéaire parfaite, ce qui maximise les scores à additionner pour le calcul de la covariance, dans le positif pour le graphique de gauche et dans le négatif pour le graphique de droite. Sur le graphique du milieu, on remarque que le manque de relation linéaire donne lieu à des carrés à la fois bleus et rouges, indiquant que les scores associés aux calculs <span class="math inline">\((X{i} - \overline{X}) (Y{i} - \overline{Y})\)</span> de la covariance s’annulent et diminuent ainsi la valeur finale de la covariance.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graphCov"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/graphCov-1.png" alt="Illustration du calcul de la covariance" width="100%"><p class="caption">
Figure 4.4: Illustration du calcul de la covariance
</p>
</div>
<p>Dans R, le coefficient de corrélation de Pearson peut être obtenu avec la fonction <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>. Dans l’exemple ci-dessous qui reprend les variables du jeu de données <code>mtcars</code> utilisées plus haut, on observe un coefficient négatif, relativement proche de -1, suggérant une relation relativement linéaire et négative entre les variables étudiées.</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -0.7761684</code></pre>
<p>Toutefois, la fonction <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> sera plus intéressante pour la suite car elle permet de calculer des indices statistiques de probabilité qui seront nécessaires dès lors qu’il s’agira de chercher à inférer la valeur d’une corrélation dans une population d’où l’échantillon étudié provient. La valeur de la corrélation est donnée à la fin de la liste des informations qui apparaissent suite à l’activation de la fonction.</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  mtcars$hp and mtcars$mpg
## t = -6.7424, df = 30, p-value = 1.788e-07
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.8852686 -0.5860994
## sample estimates:
##        cor 
## -0.7761684</code></pre>
<p>Sur la base de travaux antérieurs, Hopkins et al. <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-hopkinsProgressiveStatisticsStudies2009" role="doc-biblioref">2009</a>)</span> ont fait une proposition de classification pour qualifier la valeur du coefficient de corrélation qui serait obtenue dans le cadre d’une relation linéaire. Cette proposition est montrée dans le Tableau <a href="analyses-bivari%C3%A9es.html#tab:correlationtable">4.2</a> :</p>
<template id="87b7f37f-09dd-4938-ba28-f041c5f91991"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-5dd43cd2{}.cl-5dcb842a{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5dcb8434{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5dcb9ba4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5dcbd7f4{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd7fe{width:59pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd808{width:50.5pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd809{width:83.5pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd80a{width:130pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd812{width:130pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd81c{width:68.2pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd826{width:50.5pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd827{width:59pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5dcbd828{width:83.5pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table class="cl-5dd43cd2">
<caption class="Table Caption">
<p><span id="tab:correlationtable">Tableau 4.2: </span>Termes caractérisant la taille de l’effet en fonction de la valeur de corrélation obtenue</p>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<td class="cl-5dcbd826"><p class="cl-5dcb9ba4"><span class="cl-5dcb842a">Petite</span></p></td>
<td class="cl-5dcbd81c"><p class="cl-5dcb9ba4"><span class="cl-5dcb842a">Moyenne</span></p></td>
<td class="cl-5dcbd827"><p class="cl-5dcb9ba4"><span class="cl-5dcb842a">Grande</span></p></td>
<td class="cl-5dcbd828"><p class="cl-5dcb9ba4"><span class="cl-5dcb842a">Très grande</span></p></td>
<td class="cl-5dcbd812"><p class="cl-5dcb9ba4"><span class="cl-5dcb842a">Extrêmement grande</span></p></td>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-5dcbd808"><p class="cl-5dcb9ba4"><span class="cl-5dcb8434">0.1</span></p></td>
<td class="cl-5dcbd7f4"><p class="cl-5dcb9ba4"><span class="cl-5dcb8434">0.3</span></p></td>
<td class="cl-5dcbd7fe"><p class="cl-5dcb9ba4"><span class="cl-5dcb8434">0.5</span></p></td>
<td class="cl-5dcbd809"><p class="cl-5dcb9ba4"><span class="cl-5dcb8434">0.7</span></p></td>
<td class="cl-5dcbd80a"><p class="cl-5dcb9ba4"><span class="cl-5dcb8434">0.9</span></p></td>
</tr></tbody>
</table></div>
</div></template><div class="flextable-shadow-host" id="6ae0ead9-9ab6-4ea9-b0ec-c17951bac081"></div>
<script>
var dest = document.getElementById("6ae0ead9-9ab6-4ea9-b0ec-c17951bac081");
var template = document.getElementById("87b7f37f-09dd-4938-ba28-f041c5f91991");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><p>Pour visualiser le lien que l’on peut faire entre la forme du nuage de points et la valeur du coefficient de corrélation de Pearson que l’on peut obtenir, la page web proposée par Kristoffer Magnusson (<a href="https://rpsychologist.com/correlation" class="uri">https://rpsychologist.com/correlation</a>) peut être particulièrement intéressante. Cette page web donne la possibilité de faire varier manuellement la valeur du coefficient de corrélation de Pearson pour ensuite voir un nuage de points type correspondant à cette valeur. Faites un essai !</p>
<p>À noter que la valeur du coefficient de corrélation de Pearson est dépendante du degré de dispersion des valeurs autour de la tendance centrale <span class="citation">(Halperin, <a href="r%C3%A9f%C3%A9rences.html#ref-halperinSpuriousCorrelationsCauses1986" role="doc-biblioref">1986</a>)</span>. Ceci est illustré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:spuriousCorrelations">4.5</a>. À gauche de la figure, on observe un nuage de points représentant une relation obtenue entre deux variables quantitatives dans une population complète. La valeur du coefficient de corrélation de Pearson est ici particulièrement élevée. À droite de la figure, on observe exactement les mêmes variables dans la même population que sur le graphique de gauche, mais sur un intervalle dont l’étendue a été manuellement restreinte, diminuant ainsi la variabilité pour les deux variables. On observe alors une diminution de la valeur du coefficient de corrélation de Pearson. Cet exemple doit faire prendre conscience qu’il faut faire attention lorsqu’on cherche à comparer des coefficients de corrélation de Pearson obtenus avec des échantillons différents. En effet, si les variables correspondant respectivement à ces échantillons n’ont pas les mêmes niveaux de variabilité, les valeurs des coefficients de corrélation de Pearson ne seront pas vraiment comparables, en sachant que c’est l’échantillon qui présente la plus grande variabilité qui aura plus de chances de présenter une valeur de coefficient de corrélation de Pearson plus élevée.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:spuriousCorrelations"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/spuriousCorrelations-1.png" alt="Influence de la diminution de l'étendue des variables sur la valeur du coefficient de corrélation de Pearson" width="90%"><p class="caption">
Figure 4.5: Influence de la diminution de l’étendue des variables sur la valeur du coefficient de corrélation de Pearson
</p>
</div>
<p>Un cas particulier illustrant l’influence du degré de dispersion sur la relation étudiée est montré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:simpsonquant">4.6</a>. Cet exemple a pour but de montrer que l’étude d’une relation entre deux variables quantitatives peut aboutir à des conclusions radicalement différentes selon que l’on conduit les analyses à l’échelle d’un groupe entier ou que l’on sépare les analyses par groupe de caractéristiques, en particulier lorsque la distribution des données par groupe est radicalement différente de celle obtenue à l’échelle du groupe entier. Sur la gauche de la Figure <a href="analyses-bivari%C3%A9es.html#fig:simpsonquant">4.6</a>, le nuage de points représente la relation entre deux variables à l’échelle de l’ensemble du groupe étudié. La variabilité possible pour les deux variables étudiées (V1 et V2 dans l’exemple) est alors maximale. Toutefois, ces données appartiennent en réalité à des sous-groupes distincts (cf. couleurs sur le graphique de droite de la Figure <a href="analyses-bivari%C3%A9es.html#fig:simpsonquant">4.6</a>). L’analyse par sous-groupe diminue la variabilité à la fois pour V1 et V2, donnant même lieu ici à des relations de sens opposé à celui observé à l’échelle de l’ensemble du groupe ! Cette situation correspond à ce qu’on appelle un paradoxe de Simpson, lequel se présente lorsque le phénomène que l’on peut observer avec une vue globale est annulé voir inversé lors d’une analyse par sous-groupe. Ici, la grande variabilité associée aux données du graphique de gauche de la Figure <a href="analyses-bivari%C3%A9es.html#fig:simpsonquant">4.6</a> crée une relation artificiellement et donc faussement positive entre V1 et V2. C’est l’analyse par sous-groupe qui permet de révéler la vraie nature de la relation étudiée.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:simpsonquant"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/simpsonquant-1.png" alt="Influence du niveau d'analyse (groupe entier vs. sous-groupes) sur la corrélation observée entre deux variables quantitatives (données obtenues grâce à la fonction simulate_simpson() du package bayestestR" width="90%"><p class="caption">
Figure 4.6: Influence du niveau d’analyse (groupe entier vs. sous-groupes) sur la corrélation observée entre deux variables quantitatives (données obtenues grâce à la fonction simulate_simpson() du package bayestestR
</p>
</div>
<p>En outre, la valeur du coefficient de corrélation de Pearson peut être influencée par des valeurs extrêmes, comme montré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:spuriousCorrelationBis">4.7</a>. Les deux graphiques de cette figure montrent exactement les mêmes données, à ceci près que sur le graphique de droite, on a remplacé en ordonnées une valeur du graphique de gauche pour lui donner la valeur de 10. L’influence de cette simple action sur la valeur du coefficient de corrélation de Pearson est nette. Ceci montre qu’il faut faire attention aux valeurs extrêmes qui pourraient grandement influencer la variabilité des données d’une variable et au final la valeur de corrélation obtenue, notamment en présence d’échantillons de taille relativement faible. Dans le cas où la valeur du coefficient de corrélation de Pearson serait très influencée par une valeur, il pourrait être une bonne pratique de calculer la valeur du coefficient de corrélation de Pearson avec et sans cette valeur afin de pouvoir quantifier son influence sur la relation étudiée <span class="citation">(Halperin, <a href="r%C3%A9f%C3%A9rences.html#ref-halperinSpuriousCorrelationsCauses1986" role="doc-biblioref">1986</a>)</span>. Une alternative pourrait être aussi d’étudier la relation à l’aide d’autres types de coefficients que celui de Pearson, tels que celui de Spearman, présenté plus bas. Cet exemple doit faire prendre conscience qu’il n’est pas toujours pertinent de calculer le coefficient de corrélation de Pearson. En ce sens, lorsqu’on cherche à inférer la valeur du coefficient de corrélation de Pearson dans la population étudiée, il convient de vérifier certains prérequis, lesquels sont abordés plus loin dans ce livre.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:spuriousCorrelationBis"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/spuriousCorrelationBis-1.png" alt="Influence d'une valeur extrême sur la valeur du coefficient de corrélation de Pearson en présence d'un petit échantillon" width="90%"><p class="caption">
Figure 4.7: Influence d’une valeur extrême sur la valeur du coefficient de corrélation de Pearson en présence d’un petit échantillon
</p>
</div>
<p>Lorsque la relation étudiée ne semble pas linéaire mais s’apparente assez clairement à d’autres fonctions mathématiques, telles que des relations logarithmiques ou polynomiales, il est possible de transformer une des variables, voire les deux, pour rendre la relation linéaire et à nouveau étudiable à l’aide du coefficient de corrélation de Pearson <span class="citation">(Halperin, <a href="r%C3%A9f%C3%A9rences.html#ref-halperinSpuriousCorrelationsCauses1986" role="doc-biblioref">1986</a>)</span>. Toutefois, il est aussi possible de créer des modèles de régression non linéaires afin de regarder si ces modèles correspondent bien aux données. La détermination et la validation d’un modèle non linéaire qui correspondrait bien aux données confirmerait alors que la relation étudiée a une forme particulière et potentiellement prédictible. Les procédures pour explorer différents modèles de régression (linéaires et non linéaires) sont abordées au chapitre suivant. Enfin, une dernière alternative possible, pour étudier la relation entre deux variables quantitatives dont les distributions ne permettraient pas d’utiliser correctement le coefficient de corrélation de Pearson, serait l’utilisation de coefficients de corrélation basés sur les rangs, tels que le coefficient de corrélation de Spearman.</p>
<p><em>Le coefficient de corrélation de Spearman</em></p>
<p>Lorsque le coefficient de corrélation de Pearson ne permet pas de caractériser fiablement le degré de relation linéaire <strong>entre les valeurs</strong> de deux variables (e.g., en présence de valeurs aberrantes au sein d’un échantillon de petite taille), une alternative peut être d’étudier le degré de relation linéaire <strong>entre les rangs</strong> de ces deux variables. Le rang, c’est le classement (ou la position) d’une observation donnée au sein d’une variable en fonction de sa valeur. Dans une variable, les observations avec les valeurs les plus faibles seront associées aux rangs les plus bas alors que les observations avec les valeurs les plus élevées seront associées aux rangs les plus élevés. Une illustration de la notion de rang est proposée dans le Tableau <a href="analyses-bivari%C3%A9es.html#tab:tableranks">4.3</a> pour la variable <code>hp</code> du jeu de données <code>mtcars</code>. Dans ce tableau, les lignes ont été ordonnées sur la base des rangs de la variable <code>hp</code>. On pourra remarquer que dans le tableau, nous avons ce qu’on appelle des ex-aequos, c’est-à-dire que plusieurs observations peuvent présenter les mêmes valeurs, et donc avoir le même rang.</p>
<template id="b9fceaec-8cde-408d-b773-812ba18477a4"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-5fabd54c{}.cl-5f9f83fa{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5f9f8404{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5f9f9b06{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5f9fece6{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fecf0{width:76.8pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fecfa{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed04{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed05{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed0e{width:76.8pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed0f{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed18{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed19{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed22{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed23{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed2c{width:76.8pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed2d{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed36{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed37{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed40{width:76.8pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed4a{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed4b{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed54{width:76.8pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed55{width:68.2pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed56{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed5e{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed68{width:68.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed69{width:76.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed6a{width:68.2pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f9fed72{width:76.8pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table class="cl-5fabd54c">
<caption class="Table Caption">
<p><span id="tab:tableranks">Tableau 4.3: </span>Rangs de la variable hp du jeu de données mtcars</p>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed72"><p class="cl-5f9f9b06"><span class="cl-5f9f83fa">hp (valeur)</span></p></td>
<td class="cl-5f9fed6a"><p class="cl-5f9f9b06"><span class="cl-5f9f83fa">hp (rang)</span></p></td>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fecf0"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">52</span></p></td>
<td class="cl-5f9fece6"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">1.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed22"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">62</span></p></td>
<td class="cl-5f9fed19"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">2.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed54"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">65</span></p></td>
<td class="cl-5f9fed55"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">3.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed69"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">66</span></p></td>
<td class="cl-5f9fed68"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">4.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed54"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">66</span></p></td>
<td class="cl-5f9fed55"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">4.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">91</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">6.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed0e"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">93</span></p></td>
<td class="cl-5f9fed05"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">7.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">95</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">8.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed0e"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">97</span></p></td>
<td class="cl-5f9fed05"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">9.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed04"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">105</span></p></td>
<td class="cl-5f9fecfa"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">10.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed0e"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">109</span></p></td>
<td class="cl-5f9fed05"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">11.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed18"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">110</span></p></td>
<td class="cl-5f9fed0f"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">13.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fecf0"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">110</span></p></td>
<td class="cl-5f9fece6"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">13.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed18"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">110</span></p></td>
<td class="cl-5f9fed0f"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">13.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fecf0"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">113</span></p></td>
<td class="cl-5f9fece6"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">15.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed22"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">123</span></p></td>
<td class="cl-5f9fed19"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">16.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed2c"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">123</span></p></td>
<td class="cl-5f9fed23"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">16.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">150</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">18.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed40"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">150</span></p></td>
<td class="cl-5f9fed37"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">18.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed22"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">175</span></p></td>
<td class="cl-5f9fed19"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">21.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed2c"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">175</span></p></td>
<td class="cl-5f9fed23"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">21.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed22"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">175</span></p></td>
<td class="cl-5f9fed19"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">21.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed40"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">180</span></p></td>
<td class="cl-5f9fed37"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">24.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">180</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">24.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed40"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">180</span></p></td>
<td class="cl-5f9fed37"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">24.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">205</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">26.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed2c"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">215</span></p></td>
<td class="cl-5f9fed23"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">27.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed4b"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">230</span></p></td>
<td class="cl-5f9fed4a"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">28.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed40"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">245</span></p></td>
<td class="cl-5f9fed37"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">29.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed36"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">245</span></p></td>
<td class="cl-5f9fed2d"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">29.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed54"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">264</span></p></td>
<td class="cl-5f9fed55"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">31.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-5f9fed5e"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">335</span></p></td>
<td class="cl-5f9fed56"><p class="cl-5f9f9b06"><span class="cl-5f9f8404">32.0</span></p></td>
</tr>
</tbody>
</table></div>
</div></template><div class="flextable-shadow-host" id="c4b8905c-40cc-4422-94a2-519e9ca0cd27"></div>
<script>
var dest = document.getElementById("c4b8905c-40cc-4422-94a2-519e9ca0cd27");
var template = document.getElementById("b9fceaec-8cde-408d-b773-812ba18477a4");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><p>Le fait d’étudier l’existence d’une relation linéaire entre les rangs et non plus entre les valeurs de deux variables permet de s’affranchir de l’influence possible de valeurs très extrêmes, dans l’une et/ou l’autre variable, sur le calcul final de la corrélation. Pour déterminer alors la valeur de la corrélation, une manière de procéder est d’appliquer la méthode de calcul du coefficient de corrélation de Pearson en utilisant non plus les valeurs des variables, mais les rangs correspondants. Cette methode, c’est celle du calcul du coefficient de corrélation de Spearman (<em>rho</em>). Si l’on suit <em>stricto sensu</em> cette définition, nous pourrions alors utiliser le code suivant pour avoir le coefficient de corrélation de Spearman :</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -0.8946646</code></pre>
<p>Toutefois, il existe une manière plus directe d’écrire les choses avec la fonction <code>cor</code>, qui contient un argument spécifiquement dédié au calcul du coefficient <em>rho</em> de Spearman :</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -0.8946646</code></pre>
<p>La fonction <code>cor.test</code> permet aussi de calculer le coefficient de corrélation de Spearman en fournissant aussi des informations potentiellement intéressantes pour donner une idée de la significativité statistique de l’estimation de <em>rho</em> dans la population étudiée.</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  mtcars$hp and mtcars$mpg
## S = 10337, p-value = 5.086e-12
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.8946646</code></pre>
<p>Si l’on veut produire une représentation graphique qui illustre la valeur de <em>rho</em>, il pourrait être davantage pertinent de non plus montrer un nuage de points à partir des valeurs des variables mises en lien, mais un nuage de points à partir de leurs rangs respectifs (cf. code ci-dessous et Figure <a href="analyses-bivari%C3%A9es.html#fig:graphSpearman">4.8</a>).</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>hp_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>, mpg_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hp_rank</span>, y <span class="op">=</span> <span class="va">mpg_rank</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:graphSpearman"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/graphSpearman-1.png" alt="Graphique pour le coefficient de corrélation de Spearman" width="90%"><p class="caption">
Figure 4.8: Graphique pour le coefficient de corrélation de Spearman
</p>
</div>
<p>En matière d’interprétation, des valeurs de <em>rho</em> positives indiqueront que les deux variables mises en lien tendent à augmenter simultanément, on parlera alors de <strong>relation monotone positive</strong>. Dans le cas inverse, des valeurs négatives indiqueront que les deux variables mises en lien tendent à diminuer simultanément, on parlera alors de relation <strong>monotone négative</strong>. À noter cependant que de par son calcul, la valeur de <em>rho</em> ne permet pas de renseigner sur la forme de relation qu’il pourrait y avoir entre les valeurs des deux variables (e.g., linéaire ou curvilinéaire par exemple). Ceci est illustré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:ranksvvaluesspearman">4.9</a>. Sur cette figure, le graphique de gauche montre la relation entre les valeurs des variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>, qui est caractérisée par un coefficient de corrélation de Spearman (<em>rho</em>) de 1, indiquant donc que la relation est parfaitement monotone positive, sans préjuger de la forme particulière que pourrait présenter la relation. Pour mieux comprendre pourquoi cette valeur de <em>rho</em> est de 1, le graphique de droite de la figure montre la relation entre les rangs de ces deux variables <span class="math inline">\(X\)</span> et <span class="math inline">\(Y\)</span>. On voit que la relation entre les rangs est effectivement parfaitement linéaire.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ranksvvaluesspearman"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/ranksvvaluesspearman-1.png" alt="Distinction entre la relation observée entre les valeurs (graphique de gauche) et les rangs (graphique de droite) de deux variables" width="90%"><p class="caption">
Figure 4.9: Distinction entre la relation observée entre les valeurs (graphique de gauche) et les rangs (graphique de droite) de deux variables
</p>
</div>
</div>
</div>
<div id="relation-entre-deux-variables-qualitatives" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Relation entre deux variables qualitatives<a class="anchor" aria-label="anchor" href="#relation-entre-deux-variables-qualitatives"><i class="fas fa-link"></i></a>
</h2>
<div id="étudier-graphiquement-la-relation-1" class="section level3">
<h3>
<span class="header-section-number">4.2.1</span> Étudier graphiquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-graphiquement-la-relation-1"><i class="fas fa-link"></i></a>
</h3>
<p>Plusieurs types de graphiques peuvent être envisagés lorsqu’il s’agit de visualiser des données relatives au croisement de deux variables qualitatives. Une première approche consiste à utiliser des graphiques avec barres mises côte-à-côte, comme illustré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a>, qui a été réalisée à partir du jeu de données <code>JointSports</code>, lequel est utilisable après installation et chargement du package <code>vcd</code>. <code>JointSports</code> contient des données résumées d’effectifs mis en lien avec les modalités de différentes variables qualitatives, comme on aurait pu l’obtenir avec la fonction <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> dans les derniers exemples du chapitre précédent. (La différence qu’il y a avec ces précédents exemples est qu’ici, l’effectif est désigné par la variable <code>Freq</code>, alors qu’il s’agissait de la variable <code>n</code> auparavant.) Pour information, <code>JointSports</code> contient les données d’une enquête s’étant intéressée, en 1983 et 1985, aux opinions d’étudiants danois de 16 à 19 ans sur la pratique sportive mixte.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">vcd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reconfiguration de l'ordre des modalités de la variable opinion, et calcul </span></span>
<span><span class="co"># des effectifs totaux pour les catégories étudiées</span></span>
<span></span>
<span><span class="va">JointSports_new</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">JointSports</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>opinion <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">opinion</span>, </span>
<span>                               <span class="st">"very bad"</span>, </span>
<span>                               <span class="st">"bad"</span>, </span>
<span>                               <span class="st">"indifferent"</span>, </span>
<span>                               <span class="st">"good"</span>, </span>
<span>                               <span class="st">"very good"</span><span class="op">)</span>,</span>
<span>         gender <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">gender</span>, <span class="st">"Girl"</span>, <span class="st">"Boy"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">opinion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>Freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Freq</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création des graphiques</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">JointSports_new</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gender</span>, y <span class="op">=</span> <span class="va">Freq</span>, fill <span class="op">=</span> <span class="va">opinion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,  position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Greens"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"A : Mise en avant de la comparaison des opinions"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">JointSports_new</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">opinion</span>, y <span class="op">=</span> <span class="va">Freq</span>, fill <span class="op">=</span> <span class="va">gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,  position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"B : Mise en avant de la comparaison des genres"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:groupedBarsFigure"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/groupedBarsFigure-1.png" alt="Exemples de diagramme en barres mises côte-à-côte" width="100%"><p class="caption">
Figure 4.10: Exemples de diagramme en barres mises côte-à-côte
</p>
</div>
<p>Pour pouvoir réaliser le graphique <code>A</code> de la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a>, il a fallu indiquer dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, grâce à l’argument <code>x =</code>, la variable dont on voulait voir les modalités en abscisses, et il a fallu renseigner pour les ordonnées, à l’aide de l’argument <code>y =</code>, la variable contenant les effectifs correspondants, le tout toujours à l’intérieur de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Étant donné que les données à montrer le long de l’axe des ordonnées sont explicitement indiquées avec <code>Freq</code>, il convient d’indiquer à l’intérieur de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> l’argument <code>stat = "identity"</code>, ce qui contraint à déterminer la hauteur des barres en fonction des valeurs de la variable <code>Freq</code>. À l’intérieur de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, plus exactement au niveau de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, c’est l’argument <code>fill = opinion</code> qui a permis d’indiquer qu’on voulait des couleurs de remplissage différentes selon les modalités de la variable <code>opinion</code>. Enfin, c’est grâce à l’argument <code>position = "dodge"</code>, à l’intérieur de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, que l’on a pu obtenir des barres mises côte-à-côte, et non pas de manière empilée. Une logique similaire a été utilisée pour le graphique <code>B</code> en modifiant le code de telle sorte à ce que la distinction de l’information avec des couleurs différentes se fasse avec la variable <code>gender</code>, et non plus <code>opinion</code>.</p>
<p>Les graphiques <code>A</code> et <code>B</code> de la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a> montrent l’importance de la configuration du graphique en fonction des comparaisons que l’on veut principalement faire, et donc du message que l’on veut prioritairement délivrer. Un principe qui peut guider la conception du graphique est le fait qu’il est plus facile de comparer des barres qui sont mises juste côte-à-côte. Sur la base de ce principe, le graphique <code>A</code> de la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a> permet de comparer plus facilement les diverses opinions relevées pour les garçons d’un côté et pour les filles de l’autre, alors que le graphique <code>B</code> permet de comparer plus facilement les réponses provenant des deux genres et cela pour chaque type d’opinion. Comme indiqué par Wilke <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-wilkeFundamentalsDataVisualization2018" role="doc-biblioref">2018</a>)</span>, les types de graphiques illustrés avec les graphiques <code>A</code> et <code>B</code> de la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a> peuvent parfois se voir attribuer le reproche que s’il est relativement facile de lire les informations encodées par des positions (cf. ligne de base sur les graphiques), il peut être être difficile de lire les informations encodées par une couleur dont la signification est indiquée en légende, car cela demande un effort mental supplémentaire de garder en tête la signification de la légende lorsqu’on lit le graphique. Pour palier ce problème, qui, selon Wilke <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-wilkeFundamentalsDataVisualization2018" role="doc-biblioref">2018</a>)</span>, est au final une affaire de goût, on pourrait utiliser la fonction <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> pour créer une figure telle que la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsUpgraded">4.11</a>. Cette figure reprend la logique du graphique <code>A</code> de la Figure <a href="analyses-bivari%C3%A9es.html#fig:groupedBarsFigure">4.10</a>, avec un besoin de légende pour la variable <code>opinion</code> qui n’existe plus car la fonction <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> a permis de montrer les diagrammes en barres pour les deux genres de manière séparée, dans des encarts différents, et avec chacun leur propre axe des abscisses relatif aux modalités de la variable <code>opinion</code>.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">JointSports_new</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">opinion</span>, y <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">gender</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:groupedBarsUpgraded"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/groupedBarsUpgraded-1.png" alt="Diagrammes en barres côte-à-côte séparés selon une variable qualitative" width="100%"><p class="caption">
Figure 4.11: Diagrammes en barres côte-à-côte séparés selon une variable qualitative
</p>
</div>
<p>Dans certains cas, on peut vouloir comparer les effectifs relatifs aux modalités d’une première variable qualitative avec des barres mises côte-à-côte, et n’utiliser la seconde variable qualitative que pour avoir un peu d’éléments de contexte “à l’intérieur” des effectifs affichés pour la première variable qualitative. La Figure <a href="analyses-bivari%C3%A9es.html#fig:stackedBarsBiv">4.12</a> illustre ce cas de figure où la hauteur des barres sert prioritairement à comparer les effectifs relatifs à diverses opinions, et la coloration des barres sert à fournir une idée de la répartition (hommes / femmes dans l’exemple) dans les réponses, sans pourtant avoir l’ambition de comparer cette répartition facilement d’un type d’opinion à un autre.</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">JointSports_new</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">opinion</span>, y <span class="op">=</span> <span class="va">Freq</span>, fill <span class="op">=</span> <span class="va">gender</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_stack</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stackedBarsBiv"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/stackedBarsBiv-1.png" alt="Exemple de diagramme en barres empilées" width="90%"><p class="caption">
Figure 4.12: Exemple de diagramme en barres empilées
</p>
</div>
<p>Les graphiques présentés dans cette sous-partie montrent des valeurs d’effectifs, mais selon l’objectif, il pourrait être aussi envisagé d’utiliser ces graphiques pour montrer des proportions. Cela dit, il existe d’autres visualisations possibles des proportions pour visualiser le lien entre deux variables qualitatives. Ces visualisations peuvent être consultées dans l’ouvrage en ligne de Wilke <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-wilkeFundamentalsDataVisualization2018" role="doc-biblioref">2018</a>)</span>.</p>
</div>
<div id="étudier-numériquement-la-relation-1" class="section level3">
<h3>
<span class="header-section-number">4.2.2</span> Étudier numériquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-num%C3%A9riquement-la-relation-1"><i class="fas fa-link"></i></a>
</h3>
<p><em>Effectifs et proportions</em></p>
<p>Lorsqu’il s’agit de mener une étude numérique de la relation entre deux variables qualitatives, une première démarche à mettre en oeuvre est de récapituler numériquement les effectifs qui correspondent au croisement des deux variables. Pour cela, la fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> intégrée à R de base s’avère très pratique. Cependant, cette fonction requiert d’utiliser le jeu de données initial complet (i.e., avec toutes les observations), ce qui n’est pas le cas du jeu de données <code>JointSports</code> que nous avons utilisé précédemment, car ce dernier contient des effectifs déjà récapitulés par modalité de variable. Pour pouvoir illustrer le fonctionnement de la fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> avec les informations du jeu de données <code>JointSports</code>, j’ai donc crée un jeu de données complet qui, une fois résumé comme c’est le cas plus haut avec <code>JointSports</code>, donnerait les mêmes résultats. Ce nouveau jeu de données se nomme <code>JointSports_full</code>.</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Création du jeu de données JointSports_full</span></span>
<span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">:</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">JointSports</span><span class="op">$</span><span class="va">Freq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1983"</span>, <span class="fl">656</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1985"</span>, <span class="fl">615</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">grade</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1st"</span>, <span class="fl">350</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3rd"</span>, <span class="fl">306</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"1st"</span>, <span class="fl">354</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"3rd"</span>, <span class="fl">261</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Boy"</span>, <span class="fl">134</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="fl">216</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Boy"</span>, <span class="fl">115</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="fl">191</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Boy"</span>, <span class="fl">157</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="fl">197</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Boy"</span>, <span class="fl">104</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="fl">157</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">opinion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">51</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">38</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">103</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">67</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">29</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">23</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">39</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">36</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">61</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">72</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">39</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">41</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">67</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">35</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">77</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">27</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">31</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">31</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very good"</span>, <span class="fl">52</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"good"</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"indifferent"</span>, <span class="fl">28</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"very bad"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">JointSports_full</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">id</span>, </span>
<span>             year <span class="op">=</span> <span class="va">year</span>, </span>
<span>             grade <span class="op">=</span> <span class="va">grade</span>, </span>
<span>             gender <span class="op">=</span> <span class="va">gender</span>, </span>
<span>             opinion <span class="op">=</span> <span class="va">opinion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>opinion <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">opinion</span>, </span>
<span>                               <span class="st">"very bad"</span>, </span>
<span>                               <span class="st">"bad"</span>, </span>
<span>                               <span class="st">"indifferent"</span>, </span>
<span>                               <span class="st">"good"</span>, </span>
<span>                               <span class="st">"very good"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Une fois que l’on a un jeu de données complet sous la main, il est possible de créer ce qu’on appelle un <strong>tableau de contingence</strong>, c’est-à-dire ici un tableau qui récapitule numériquement les effectifs à la croisée des deux variables qui nous intéressent. Pour faire cela, on peut utiliser la fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> en suivant différentes méthodes montrées ci-dessous. (Le code montré ci-dessous aboutit aux mêmes informations que celles montrées sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:stackedBarsBiv">4.12</a> ci-dessus.)</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1ère méthode</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">JointSports_full</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">opinion</span>, <span class="va">gender</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2ème méthode</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">JointSports_full</span><span class="op">$</span><span class="va">opinion</span>, <span class="va">JointSports_full</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualisation du tableau de contingence</span></span>
<span><span class="va">tab</span></span></code></pre></div>
<pre><code>##              
##               Boy Girl
##   very bad     15   11
##   bad          41   45
##   indifferent 140  123
##   good        188  289
##   very good   126  293</code></pre>
<p>Un tableau de contingence permet donc de comparer des effectifs en fonction de plusieurs modalités et variables à la fois. Le problème, lorsqu’on utilise des effectifs, est que certaines comparaisons peuvent être difficiles à faire lorsque les effectifs totaux liés aux différentes modalités ne sont pas comparables. Par exemple, dans le résultat montré ci-dessus, l’effectif total des filles est de 761 alors que celui des garçons est de 510, ce qui rend difficile la comparaison des garçons et des filles pour les différents types d’opinion recensés dans l’enquête danoise présentée plus haut. C’est pour cela qu’il convient, dans certains cas, de calculer les proportions correspondant à ces différents effectifs. Pour ce faire, on peut :</p>
<ul>
<li>Utiliser la fonction <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code>, qui va convertir en proportions les effectifs montrés plus haut en considérant l’effectif total de tout le tableau :</li>
</ul>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>##              
##                 Boy  Girl
##   very bad     1.18  0.87
##   bad          3.23  3.54
##   indifferent 11.01  9.68
##   good        14.79 22.74
##   very good    9.91 23.05</code></pre>
<ul>
<li>Utiliser la fonction <code><a href="https://juba.github.io/questionr/reference/rprop.html">lprop()</a></code> du package <code>questionr</code>, qui va convertir en proportions les effectifs montrés plus haut en considérant l’effectif total de chaque ligne du tableau :</li>
</ul>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://juba.github.io/questionr/">questionr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://juba.github.io/questionr/reference/rprop.html">lprop</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code>##              
##               Boy   Girl  Total
##   very bad     57.7  42.3 100.0
##   bad          47.7  52.3 100.0
##   indifferent  53.2  46.8 100.0
##   good         39.4  60.6 100.0
##   very good    30.1  69.9 100.0
##   All          40.1  59.9 100.0</code></pre>
<ul>
<li>Utiliser la fonction <code><a href="https://juba.github.io/questionr/reference/cprop.html">cprop()</a></code> du package <code>questionr</code>, qui va convertir en proportions les effectifs montrés plus haut en considérant l’effectif total de chaque colonne du tableau :</li>
</ul>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://juba.github.io/questionr/">questionr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://juba.github.io/questionr/reference/cprop.html">cprop</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code>##              
##               Boy   Girl  All  
##   very bad      2.9   1.4   2.0
##   bad           8.0   5.9   6.8
##   indifferent  27.5  16.2  20.7
##   good         36.9  38.0  37.5
##   very good    24.7  38.5  33.0
##   Total       100.0 100.0 100.0</code></pre>
<p>Il convient de noter que les proportions données par ces différentes fonctions doivent être utilisées selon les comparaisons que l’on veut faire. L’analyse descriptive consiste alors à voir si, tant d’un point de vue graphique que numérique, on observe des différences de scores particulières entre les modalités d’une variable qualitative en fonction des modalités de l’autre variable qualitative. Si l’on considère le dernier tableau de résultats ci-dessus, on peut par exemple observer une très légère tendance à ce que les garçons soient davantage polarisés, par rapport aux filles, sur des opinions négatives vis-à-vis des pratiques sportives mixtes, alors que les filles seraient légèrement plus polarisées que les garçons sur des opinions positives, ce qui n’empêche pas que, pour les deux genres, il y a une polarisation principale sur des opinions neutres à positives.</p>
<p>Si les proportions permettent en principe de mieux comparer les effectifs de sous-groupes (e.g., les opinions par groupe de genre dans l’exemple ci-dessus) lorsque les effectifs des groupes parents sont de tailles différentes (comme c’est le cas pour les groupes de genre dans l’exemple ci-dessus), il convient tout de même de faire attention aux conclusions que l’on tire lorsqu’on s’en tient à une analyse globale, car ces conclusions dépendent de la manière dont les individus des groupes parents sont répartis dans chacun des sous-groupes. Un exemple connu qui permet d’illustrer cette vigilance à avoir lorsqu’on étudie le croisement de variables qualitatives est le cas du taux de réussite des femmes à l’université de Berkeley en 1973, qui apparaissait bien inférieur à celui des hommes lorsqu’on considérait les taux de réussite par genre à l’échelle de l’ensemble de l’université <span class="citation">(Bickel et al., <a href="r%C3%A9f%C3%A9rences.html#ref-bickelSexBiasGraduate1975" role="doc-biblioref">1975</a>)</span>, avec 30.3 % de réussite chez les femmes contre 44.5 % de réussite chez les hommes (cf. Figure <a href="analyses-bivari%C3%A9es.html#fig:taballUCBA">4.13</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:taballUCBA"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/taballUCBA-1.png" alt="Taux de réussite des étudiants femmes et hommes à l'Université de Berkeley en 1973, approche globale (Bickel et al., 1975)" width="90%"><p class="caption">
Figure 4.13: Taux de réussite des étudiants femmes et hommes à l’Université de Berkeley en 1973, approche globale (Bickel et al., 1975)
</p>
</div>
<p>Toutefois, une analyse par département permettait de voir que les taux de réussite des femmes étaient en réalité supérieurs voire nettement supérieurs à ceux des hommes dans la plupart des départements (cf. Figure <a href="analyses-bivari%C3%A9es.html#fig:tabdepUCBA">4.14</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tabdepUCBA"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/tabdepUCBA-1.png" alt="Taux de réussite des étudiants femmes et hommes à l'Université de Berkeley en 1973, approche par département (Bickel et al., 1975)" width="100%"><p class="caption">
Figure 4.14: Taux de réussite des étudiants femmes et hommes à l’Université de Berkeley en 1973, approche par département (Bickel et al., 1975)
</p>
</div>
<p>Cette situation, qui peut paraître étonnante, illustre à nouveau ce qu’on appelle un paradoxe de Simpson. Dans le cas présent, l’apparent paradoxe s’explique par le fait que, contrairement aux hommes, la majorité des femmes avaient candidaté dans des départements qui étaient très sélectifs, c’est-à-dire où le taux de réussite était faible (il l’était aussi pour les hommes). Très peu de femmes avaient candidaté là où les taux de réussite étaient très élevés (pour les femmes comme pour les hommes). Ceci est illustré sur la Figure <a href="analyses-bivari%C3%A9es.html#fig:distriUCBA">4.15</a>. On voit bien que la majorité des femmes étaient inscrites dans les départements ici montrés avec les lettres allant de C à F, or ces départements étaient associés à des taux de réussite inférieurs à 40 % seulement, que cela soit pour les hommes ou pour les femmes (cf. Figure <a href="analyses-bivari%C3%A9es.html#fig:tabdepUCBA">4.14</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:distriUCBA"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/distriUCBA-1.png" alt="Distribution des étudiants femmes et hommes par département à l'Université de Berkeley en 1973 (Bickel et al., 1975)" width="90%"><p class="caption">
Figure 4.15: Distribution des étudiants femmes et hommes par département à l’Université de Berkeley en 1973 (Bickel et al., 1975)
</p>
</div>
<p>Autrement dit, les hommes se retrouvaient avec un pourcentage de réussite global bien meilleur que celui des femmes seulement parce que, comparativement aux femmes, les hommes s’étaient en proportion davantage engagés dans les départements où les taux de réussite étaient bien meilleurs.</p>
</div>
</div>
<div id="relation-entre-une-variable-quantitative-et-une-variable-qualitative" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Relation entre une variable quantitative et une variable qualitative<a class="anchor" aria-label="anchor" href="#relation-entre-une-variable-quantitative-et-une-variable-qualitative"><i class="fas fa-link"></i></a>
</h2>
<p>Lorsqu’on analyse une variable quantitative en fonction d’une variable qualitative, on peut avoir des données quantitatives qui sont non appariées (étude de type <em>between-subject design</em> en anglais) ou appariées (étude de type <em>within-subject design</em> en anglais). Avoir des données non appariées signifie que les données quantitatives correspondant aux différentes modalités de la variable qualitative étudiée ne sont pas liées. Un exemple simple, pour ce premier cas, peut être l’analyse de la taille des individus en fonction du sexe. Dans ce cas, les données quantitatives de taille pour les personnes de sexe masculin, de sexe féminin, et de sexe indéterminé, proviendront forcément d’individus différents et ne formeront donc pas des paires. Les cas de données appariées se retrouvent dans les études dans lesquelles plusieurs individus sont évalués plusieurs fois dans des conditions similaires ou différentes et que l’on cherche à comparer. En sciences du sport, un exemple relativement classique est de tester la performance d’endurance (variable quantitative) en ayant pris (condition de test) ou non (condition contrôle) une substance potentiellement ergonénique, la prise de substance ou non étant les modalités d’une même variable qualitative de type condition. Dans ce cas là, tous les individus auront des données dans les deux conditions et ces données seront donc appariées (dépendantes).</p>
<p>Étant donné que les contraintes graphiques et les statistiques à calculer diffèrent selon que l’on est en présence de (i) deux groupes (1 variable quantitative x 1 variable qualitative avec 2 modalités) ou (ii) trois groupes et plus (1 variable quantitative x 1 variable qualitative avec 3 modalités ou plus), les procédures graphiques et calculatoires présentées ci-après sont distinguées selon ces deux grands cas de figure.</p>
<div id="comparaison-de-deux-groupes-de-données" class="section level3">
<h3>
<span class="header-section-number">4.3.1</span> Comparaison de deux groupes de données<a class="anchor" aria-label="anchor" href="#comparaison-de-deux-groupes-de-donn%C3%A9es"><i class="fas fa-link"></i></a>
</h3>
<div id="étudier-graphiquement-la-relation-2" class="section level4">
<h4>
<span class="header-section-number">4.3.1.1</span> Étudier graphiquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-graphiquement-la-relation-2"><i class="fas fa-link"></i></a>
</h4>
<p>Lorsque l’on cherche à explorer la relation qu’il peut y avoir entre une variable quantitative et une variable qualitative, il peut être intéressant de visualiser la distribution de la variable quantitative en fonction de chaque modalité de la variable qualitative. Pour faire cela, il a été proposé dans la littérature d’user de graphiques appelés <em>raincloud plots</em> qui combinent les avantages de plusieurs techniques graphiques et statistiques et par là même pallient les manques ou défauts inhérents à chacune de ces techniques <span class="citation">(Allen et al., <a href="r%C3%A9f%C3%A9rences.html#ref-allenRaincloudPlotsMultiplatform2019" role="doc-biblioref">2019</a>)</span>. Les blocs de code ci-dessous, et les Figures <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired1">4.16</a>, <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired2">4.17</a> et <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivPaired1">4.18</a>, proposent plusieurs options de mise en oeuvre de ce type de graphiques selon la situation d’étude (avec données non appariées et appariées).</p>
<p><em>Données non appariées</em></p>
<p>Les Figures <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired1">4.16</a> et <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired2">4.17</a> et les blocs de code associés montrés ci-dessous permettent d’obtenir des graphiques appropriés pour des données non appariées.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Configuration du jeu de données pour les exemples avec données non appariées.</span></span>
<span><span class="co"># Il s'agit ici d'obtenir le jeu de données `iris` avec seulement deux modalités  </span></span>
<span><span class="co"># de la variable `Species`, cela en enlevant la modalité `virginica`.</span></span>
<span><span class="va">iris_two_species</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">!=</span> <span class="st">"virginica"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">############################################################</span></span>
<span><span class="co"># Raincloud plots à l'horizontale pour données non appariées</span></span>
<span><span class="co">############################################################</span></span>
<span></span>
<span><span class="co"># Raincloud plots classiques (avec boîtes à moustaches)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gghalves</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gghalves/man/geom_half_point.html">geom_half_point</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    side <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>    range_scale <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    transformation <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots avec les nuages sur une même ligne (avec boîtes à moustaches)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.07</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span></span>
<span>                          dodge.width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123</span></span>
<span>                    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots classiques (avec moyennes et </span></span>
<span><span class="co"># écart-types)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>    fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">0.08</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gghalves</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gghalves/man/geom_half_point.html">geom_half_point</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    side <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>    range_scale <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    transformation <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots avec les nuages sur une même ligne (avec moyennes et </span></span>
<span><span class="co"># écart-types)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>    fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">0.07</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span></span>
<span>                          dodge.width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123</span></span>
<span>                    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raindcloudplotsBivUnpaired1"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/raindcloudplotsBivUnpaired1-1.png" alt="Exemples de raindcloud plots à l'horizontale pour des données non appariées" width="100%"><p class="caption">
Figure 4.16: Exemples de raindcloud plots à l’horizontale pour des données non appariées
</p>
</div>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###########################################################</span></span>
<span><span class="co"># Raincloud plots à la verticale pour données non appariées</span></span>
<span><span class="co">###########################################################</span></span>
<span></span>
<span><span class="co"># Raincloud plots classiques (avec boîtes à moustaches)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gghalves</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gghalves/man/geom_half_point.html">geom_half_point</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    side <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>    range_scale <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    transformation <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots avec les nuages sur une même ligne (avec boîtes à moustaches)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.07</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.1</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span></span>
<span>                          dodge.width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123</span></span>
<span>                    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Raincloud plots classiques (avec moyennes et écart-types)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>    fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">0.06</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gghalves</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gghalves/man/geom_half_point.html">geom_half_point</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    side <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>    range_scale <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    transformation <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots avec les nuages sur une même ligne (avec moyennes et écart-types)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, colour <span class="op">=</span> <span class="va">Species</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>    fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">0.03</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span></span>
<span>                          dodge.width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">123</span></span>
<span>                    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raindcloudplotsBivUnpaired2"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/raindcloudplotsBivUnpaired2-1.png" alt="Exemples de raindcloud plots à la verticale pour des données non appariées" width="100%"><p class="caption">
Figure 4.17: Exemples de raindcloud plots à la verticale pour des données non appariées
</p>
</div>
<p>Comme vous l’aurez peut-être repéré, il s’agit ici des mêmes techniques de codage qui ont été vues au cours du chapitre précédent lors de la présentation du <em>raincloud plot</em>, à ceci près qu’il y a un <em>mapping</em> (une mise en lien) des couleurs des éléments graphiques avec les modalités de la variable qualitative étudiée (cf. arguments <code>color</code> et <code>fill</code> dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> au niveau de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>). Notons aussi que pour montrer les moyennes et écarts-types sur les figures <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired1">4.16</a> et <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired2">4.17</a>, il a fallu utiliser la fonction <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>. Cette fonction sert à visualiser un résumé statistique identifié. Pour montrer les moyennes, on utilise <code>fun = "mean"</code>, alors que pour montrer des écarts-types, on utilise <code>fun.data = "mean_sdl"</code>. Pour les écarts-types, il faut ajouter <code>fun.args = list(mult = 1)</code> pour bien montrer une barre d’erreur ne correspondant qu’à un seul multiple de l’écart-type, car par défaut c’est deux fois l’écart-type qui est montré. On peut choisir la forme avec laquelle présenter le résumé statistique grâce à l’argument <code>geom</code>. On remarque aussi que pour montrer les “nuages” sur une même ligne (cf. graphiques B et D des Figures <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired1">4.16</a> et <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired2">4.17</a>), nous avons utilisé <code>aes(x = 0)</code> dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, et nous avons montré les données individuelles avec la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> et non plus avec <code><a href="https://rdrr.io/pkg/gghalves/man/geom_half_point.html">gghalves::geom_half_point()</a></code> comme au chapitre précédent ou même comme avec les graphiques A et C des mêmes figures, cela pour avoir plus de contrôle sur le placement des points sur les graphiques. C’est alors l’argument <code>position</code> et la fonction <code><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge()</a></code> qui ont permis de donner un mouvement latéral aléatoire aux points pour qu’ils ne soient pas superposés.</p>
<p><em>Données appariées</em></p>
<p>La Figure <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivPaired1">4.18</a> montre des propositions de graphiques dans le cas de l’étude d’une comparaison de deux groupes de données appariées. Pour ces exemples, nous avons installé le package <code>PairedData</code> et chargé le jeu de données associé, appelé <code>Blink</code>. Pour information, <code>Blink</code> contient des données de taux de clignotement des yeux obtenues chez 12 sujets et dans deux conditions différentes : une tâche où il fallait diriger un stylo selon une trajectoire rectiligne (modalité <code>Straight</code>), et une tâche où il fallait diriger un stylo selon une trajectoire présentant des oscillations (<code>Oscillating</code>). Ce jeu de données a été un peu transformé pour pouvoir passer à l’étape de la conception graphique, comme montré ci-dessous.</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Configuration du jeu de données pour les exemples avec données appariées</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PairedData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Blink</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Blink2</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">Blink</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Straight</span>, <span class="va">Oscillating</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"Blink_rate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Condition <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">Condition</span>, <span class="st">"Straight"</span>, <span class="st">"Oscillating"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#######################################################</span></span>
<span><span class="co"># Raincloud plots à la verticale pour données appariées</span></span>
<span><span class="co">#######################################################</span></span>
<span></span>
<span><span class="co"># Raincloud plots classiques à la verticale avec boîtes à moustaches</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Blink2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Condition</span>, y <span class="op">=</span> <span class="va">Blink_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">.1</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="fl">1.1</span>, <span class="fl">1.9</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span>, width <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="fl">1.1</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="va">Subject</span></span>
<span>      <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span>, width <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Raincloud plots classiques à la verticale avec moyennes et écart-types</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Blink2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Condition</span>, y <span class="op">=</span> <span class="va">Blink_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">stat_halfeye</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    adjust <span class="op">=</span> <span class="fl">.5</span>, </span>
<span>    width <span class="op">=</span> <span class="fl">.6</span>, </span>
<span>    .width <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    point_colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    fun.data  <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>    fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mul <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">0.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="fl">1.1</span>, <span class="fl">1.9</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span>, width <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Condition</span> <span class="op">==</span> <span class="st">"Straight"</span>, <span class="fl">1.1</span>, <span class="fl">1.9</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="va">Subject</span></span>
<span>      <span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">123</span>, width <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey50"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    fun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raindcloudplotsBivPaired1"></span>
<img src="Analyser-des-donne%CC%81es-avec-R_files/figure-html/raindcloudplotsBivPaired1-1.png" alt="Exemples de raindcloud plots à la verticale pour des données appariées" width="100%"><p class="caption">
Figure 4.18: Exemples de raindcloud plots à la verticale pour des données appariées
</p>
</div>
<p>Les graphiques montrés ci-dessus pour données appariées contiennent des éléments graphiques supplémentaires par rapport à ceux proposés pour les données non appariées : des lignes reliant les données individuelles, et une ligne reliant les statistiques qui représentent les tendances centrales (i.e., les médianes ou les moyennes). Ces deux types d’éléments graphiques sont importants pour explicitement montrer qu’il y a un lien entre les deux conditions de mesure (il s’agit des mêmes individus et donc du même groupe), et cela permet de mettre en évidence à la fois les trajectoires individuelles et celle du groupe entre les deux conditions de mesure.</p>
<p>Pour parvenir à réaliser les graphiques ci-dessus, il a fallu user de quelques techniques supplémentaires par rapport à ce qui avait déjà été vu auparavant. Tout d’abord, on retrouve la fonction <code><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html">ggdist::stat_halfeye()</a></code> qui sert toujours à montrer les formes des distributions. Toutefois, on peut noter que l’argument <code>side</code> dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> a été configuré avec une fonction conditionnelle de telle sorte à orienter sur la gauche ou la droite la forme du nuage de la distribution selon la modalité considérée (<code>Straight</code> ou <code>Oscillating</code> ici). Par ailleurs, s’agissant des données individuelles, elles ont été ajoutées ici avec la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, avec à nouveau une définition du placement sur l’axe des abscisses (<code>x</code>) ajustée selon la modalité concernée. Pour comprendre l’origine des valeurs <code>1.1</code> et <code>1.9</code> utilisées pour placer les données individuelles le long de l’axe <code>x</code> (cf. code ci-dessus), il faut savoir qu’un graphique qui a une variable qualitative sur l’axe de abscisses, cela dans le cadre d’une fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, attribue les valeurs de 1 et 2 aux deux modalités du jeu de données, ce qui laisse possible l’ajustement <em>a posteriori</em> de la position des données individuelles avec des valeurs numériques. Les lignes individuelles ont été rajoutées à l’aide de la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> avec la même configuration que pour la fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> afin de bien faire correspondre les points et les lignes. L’élément important supplémentaire à indiquer dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> associée à <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> est l’argument <code>group = Subject</code> pour bien indiquer que chaque ligne appartient respectivement à un couple d’observations de la variable <code>Subject</code>. Enfin, sur chacun des deux graphiques, les lignes reliant les médianes ou les moyennes ont été ajoutées grâce à la fonction <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>, avec la particularité de configurer le terme <code>group</code>avec la valeur de <code>1</code>. Il est possible que quelques ajustements manuels doivent être faits pour reproduire ce type de graphiques en présence d’un autre jeu de données, mais la structure globale du code devrait pouvoir constituer une bonne base de départ.</p>
</div>
<div id="étudier-numériquement-la-relation-2" class="section level4">
<h4>
<span class="header-section-number">4.3.1.2</span> Étudier numériquement la relation<a class="anchor" aria-label="anchor" href="#%C3%A9tudier-num%C3%A9riquement-la-relation-2"><i class="fas fa-link"></i></a>
</h4>
<p>De manière générale, étudier la relation entre une variable quantitative et une variable qualitative revient souvent à comparer les valeurs que prend la variable quantitative en fonction des modalités de la variable qualitative. L’observation de différences de scores entre les modalités pourrait alors indiquer qu’il y a un lien entre la variable qualitative (qu’on pourrait appeler <strong>variable facteur</strong>) et la variable quantitative (qu’on pourrait appeler <strong>variable réponse</strong>). À noter que la démonstration d’un lien de cause à effet entre la variable quantitative et la variable qualitative ne pourra être effective que si l’on a sciemment fait varier les modalités de la variable qualitative pour en observer la conséquence sur les valeurs de la variable quantitative.</p>
<p>De prime abord, l’analyse qui pourrait être envisagée pour comparer deux groupes serait d’utiliser simplement la différence entre les moyennes des deux groupes. Toutefois, en se restreignant à cela, il pourrait être difficile de porter un jugement sur la grandeur relative de la différence entre les groupes comparés, qu’on pourrait appeler <strong>taille d’effet</strong>. Il serait également difficile de comparer cette taille d’effet avec celles observées dans d’autres études, en particulier celles traitant de thématiques différentes, car en étant calculée de la sorte, la taille d’effet serait inhérente à la nature des variables investiguées et à la grandeur des valeurs mesurées dans l’étude. Il est donc intéressant, dans ce genre de situations, de standardiser la différence de scores obtenue entre les deux groupes. Dans la littérature, la procédure de standardisation a été très développée pour la comparaison de moyennes. Pour cette raison, les sous-parties suivantes qui traitent de la comparaison de deux groupes présentent essentiellement les calculs pour obtenir une taille d’effet en vue de comparer des moyennes. Ces calculs sont repris de l’article de Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>. Quelques mots seront toutefois donnés pour les situations pour lesquelles ces calculs risqueraient de ne pas être appropriés.</p>
</div>
</div>
<div id="cas-de-deux-groupes-de-données-indépendants-données-non-appariées" class="section level3">
<h3>
<span class="header-section-number">4.3.2</span> Cas de deux groupes de données indépendants (données non appariées)<a class="anchor" aria-label="anchor" href="#cas-de-deux-groupes-de-donn%C3%A9es-ind%C3%A9pendants-donn%C3%A9es-non-appari%C3%A9es"><i class="fas fa-link"></i></a>
</h3>
<p><strong><span class="math inline">\(d_{s}\)</span> de Cohen</strong></p>
<p>Classiquement, l’indice statistique utilisé pour calculer une différence de moyennes de manière standardisée entre deux groupes de données non appariées, à partir d’échantillons de population, est le <span class="math inline">\(d_{s}\)</span> de Cohen. Cette statistique se calcule en faisant la différence entre les moyennes des deux groupes à comparer, et en divisant cette différence par l’écart-type commun des valeurs de chacun des deux groupes. Ce calcul est montré ci-dessous :</p>
<p><span class="math display">\[d_{s} = \frac{\overline{X}_{1} - \overline{X}_{2}} {\sqrt{\frac{(N_{1} - 1) \hat{\sigma}_{1}^2 + (N_{2} - 1) \hat{\sigma}_{2}^2} {N_{1} + N_{2} - 2}}}\]</span></p>
<p>Dans R, le <span class="math inline">\(d_{s}\)</span> de Cohen peut être calculé à l’aide de la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d()</a></code> du package <code>effectsize</code>, qui nécessite d’être installé puis chargé avant d’être utilisé.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/effectsize/">effectsize</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d</a></span><span class="op">(</span></span>
<span>  <span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, </span>
<span>  data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Cohen's d |         95% CI
## --------------------------
## -2.10     | [-2.59, -1.61]
## 
## - Estimated using pooled SD.</code></pre>
<p>Dans cet exemple, on remarque qu’on a bien cherché à savoir comment les données de la variable <code>Sepal.Length</code> pouvaient différer en fonction (<code>~</code>) des modalités de la variable <code>Species</code>. Si la fonction nous donne un résultat, il faut toutefois bien faire attention au sens du calcul qui a été réalisé. Configurée de la sorte, la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d()</a></code> réalise la différence <strong>modalité 1 - modalité 2</strong>. Il faut donc savoir quelle est la modalité 1 et quelle est la modalité 2 dans la variable <code>Species</code> pour ensuite pouvoir interpréter le signe du résultat, qui est négatif ici avec la valeur de -2.10. Pour ce faire, on peut utiliser la fonction <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code> :</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">iris_two_species</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "setosa"     "versicolor" "virginica"</code></pre>
<p>L’ordre des modalités affichées nous indique que <code>setosa</code> est la modalité 1, et que <code>versicolor</code> est la modalité 2. (On remarque par ailleurs que le jeu de données <code>iris_two_species</code> contient toujours trois modalités à la suite du filtrage précédent du jeu de données <code>iris</code> à l’aide de la fonction <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>). Par conséquent, le <span class="math inline">\(d_{s}\)</span> de Cohen de -2.10 obtenu plus haut indique que la longueur des sépales (<code>Sepal.Length</code>) pour l’espèce <code>setosa</code> est inférieure à celles des sépales de l’espèce <code>versicolor</code>. Cette interprétation est en cohérence avec les graphiques réalisés au préalable (cf. Figures <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired1">4.16</a> et <a href="analyses-bivari%C3%A9es.html#fig:raindcloudplotsBivUnpaired2">4.17</a>). Si l’on avait voulu avoir le calcul inverse (<code>versicolor</code> - <code>setosa</code>), il aurait fallu reconfigurer l’ordre des modalités, par exemple à l’aide de la fonction <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> du package <code>forcats</code> comme montré à la fin du chapitre 3.</p>
<p>Une fois que l’on a calculé une taille d’effet, il est toujours intéressant d’essayer de formuler un jugement sur l’importance, l’ampleur de l’effet. En ce sens, des valeurs seuils ont été proposées dans la littérature (Cohen, 1988; in Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>). Ces valeurs, valables pour interpréter des tailles d’effet dans le cadre d’une étude de type <em>between-subject design</em>, sont montrées dans le tableau ci-dessous.</p>
<template id="32b5e7cd-6167-4b58-b7fd-7583384721bd"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-67a5a246{}.cl-679dbd7e{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-679dbd92{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-679dd368{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-679e0bc6{width:52.9pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679e0bda{width:55.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679e0be4{width:44.4pt;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679e0bee{width:52.9pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679e0bef{width:55.4pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679e0bf8{width:44.4pt;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<div class="inline-table"><table class="cl-67a5a246">
<caption class="Table Caption">
<p><span id="tab:effectsizetable">Tableau 4.4: </span>Termes pour qualifier la taille d’effet dans le cadre d’une comparaison de moyennes associées à des variables indépendantes</p>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<td class="cl-679e0bf8"><p class="cl-679dd368"><span class="cl-679dbd7e">Petit</span></p></td>
<td class="cl-679e0bef"><p class="cl-679dd368"><span class="cl-679dbd7e">Moyen</span></p></td>
<td class="cl-679e0bee"><p class="cl-679dd368"><span class="cl-679dbd7e">Grand</span></p></td>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-679e0be4"><p class="cl-679dd368"><span class="cl-679dbd92">0.2</span></p></td>
<td class="cl-679e0bda"><p class="cl-679dd368"><span class="cl-679dbd92">0.5</span></p></td>
<td class="cl-679e0bc6"><p class="cl-679dd368"><span class="cl-679dbd92">0.8</span></p></td>
</tr></tbody>
</table></div>
</div></template><div class="flextable-shadow-host" id="464b0da8-f75d-4c61-813f-9a1677308c92"></div>
<script>
var dest = document.getElementById("464b0da8-f75d-4c61-813f-9a1677308c92");
var template = document.getElementById("32b5e7cd-6167-4b58-b7fd-7583384721bd");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><p>Ces valeurs sont relativement arbitraires, et l’interprétation de la taille de l’effet et des conséquences que l’effet peut avoir en pratique ne devrait pas être liée de manière trop rigide à ces valeurs <span class="citation">(Lakens, <a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Il existe également une autre approche pour interpréter une valeur de taille d’effet : l’approche <em>Common Language explanation</em> <span class="citation">(Lakens, <a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>. Cette approche consiste à faire le lien entre la valeur de la taille d’effet et les probabilités de rencontrer des valeurs similaires ou supérieures dans un groupe en comparaison à un autre. Par exemple, lorsqu’on obtient un <span class="math inline">\(d_{s}\)</span> de Cohen de 0.80, cela peut se traduire par le fait qu’il y a 71.4 % de chances qu’une personne prise au hasard dans le groupe avec la meilleure moyenne ait un score plus élevé qu’une personne qui serait prise au hasard dans le groupe avec la moyenne la plus basse des deux groupes. Kristoffer Magnusson a réalisé une page web qui permet d’utiliser l’approche <em>Common Language explanation</em> pour n’importe quelle valeur de taille d’effet dans le cadre d’une étude de type <em>between-subject design</em>. Jetez donc un oeil au lien suivant pour plus de détails : <a href="https://rpsychologist.com/cohend" class="uri">https://rpsychologist.com/cohend</a>.</p>
<p><strong><span class="math inline">\(g_{s}\)</span> de Hedges</strong></p>
<p>Il a été rapporté, dans la littérature, qu’en réalité le <span class="math inline">\(d_{s}\)</span> de Cohen est relativement biaisé lorsqu’il s’agit d’estimer la taille d’un effet dans la population d’intérêt à partir d’échantillons de population. Autrement dit, à l’échelle de nombreux échantillons, on sait qu’avec le <span class="math inline">\(d_{s}\)</span> de Cohen on aura en moyenne un écart entre l’effet qu’on a trouvé et l’effet réel qui existe dans la population. Cela sera d’autant plus vrai lorsque les calculs seront réalisés à partir de petits échantillons (<span class="math inline">\(N\)</span> &lt; 20), selon Hedges et Okins (1985) cités par Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>. En raison de cela, un autre indice statistique a été proposé pour corriger cette erreur systématique qui sera d’autant plus grande que l’échantillon étudié est petit, à savoir le <span class="math inline">\(g_{s}\)</span> de Hedges :</p>
<p><span class="math display">\[g_{s} = d_{s} (1 - \frac{3}{4(N_{1} + N_{2}) - 9})\]</span></p>
<p>Dans R, le <span class="math inline">\(g_{s}\)</span> de Hedges lié à un échantillon de population peut être calculé à l’aide de la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g()</a></code> du package <code>effectsize</code> :</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g</a></span><span class="op">(</span></span>
<span>  <span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">iris_two_species</span>, </span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Hedges' g |         95% CI
## --------------------------
## -2.09     | [-2.57, -1.60]
## 
## - Estimated using pooled SD.</code></pre>
<p>Ici, la valeur ne change pas beaucoup par rapport au cas précédent, car l’effectif n’est pas si petit que cela (<span class="math inline">\(N_{1}\)</span> + <span class="math inline">\(N_{2}\)</span> = 100 ici, ce qui fait que la correction appliquée au <span class="math inline">\(d_{s}\)</span> de Cohen est minime).</p>
<p><strong>Delta de Glass</strong></p>
<p>Dans certains cas où l’on souhaiterait comparer les scores de deux groupes indépendants pour tester l’effet de deux conditions expérimentales différentes, l’expérimentation en tant que telle peut influencer, au-delà de la moyenne, l’écart-type de la variable réponse dans un des deux groupes. On peut se trouver dans ce genre de situation lorsque l’on compare les données post-programme d’un groupe entraîné ou traité à celles d’un groupe contrôle. En effet, le groupe entraîné/traité peut voir son écart-type changé au terme d’un programme en raison d’une réponse individuelle hétérogène à ce programme, ce qui ne sera pas en principe le cas du groupe contrôle. Dans ce genre de situations, des indices statistiques autres que le <span class="math inline">\(g_{s}\)</span> de Hedges mériteraient d’être calculés, tels que le delta (<span class="math inline">\(\Delta\)</span>) de Glass <span class="citation">(Lakens, <a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span> :</p>
<p><span class="math display">\[\Delta = \frac{\overline{X}_{1} - \overline{X}_{2}} {\hat{\sigma}_{2}}\]</span></p>
<p>Le calcul du <span class="math inline">\(\Delta\)</span> de Glass est dans l’idée le même que celui du <span class="math inline">\(d_{s}\)</span> de Cohen, sauf que la différence entre les moyennes des deux groupes n’est pas divisée par l’écart-type commun des deux groupes, mais par celui d’un seul des deux groupes, qui serait en principe celui qui représenterait la condition contrôle ou la condition de référence. Une pratique souvent recommandée pour comparer dans ce genre de situation les scores post-programme de deux groupes (un groupe entraîné/traité et un groupe contrôle) serait d’utiliser l’écart-type des scores du groupe contrôle obtenu en pré-programme <span class="citation">(Lakens, <a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Dans R, le <span class="math inline">\(\Delta\)</span> de Glass lié à un échantillon de population peut être calculé à l’aide de la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">glass_delta()</a></code> du package <code>effectsize</code>. Attention, l’écart-type utilisé dans le code suivant est celui de la variable quantitative associée à la modalité 2 de la variable qualitative, qui est toujours <code>versicolor</code> dans cet exemple (exemple dont le contexte n’est certes pas celui d’un programme dont on cherche l’effet, mais le principe d’utilisation du code reste le même).</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">glass_delta</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, </span>
<span>            data <span class="op">=</span> <span class="va">iris_two_species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Glass' delta |         95% CI
## -----------------------------
## -1.80        | [-2.29, -1.31]</code></pre>
<p>Notons quand même que l’utilisation du <span class="math inline">\(\Delta\)</span> de Glass semble peu courante dans les études cherchant à tester l’effet d’un programme. L’une des difficultés liées à son utilisation est que cela suggère que les groupes à comparer soient identiques en pré-programme pour la variable étudiée. En général, des procédures un peu plus sophistiquées sont utilisées pour déterminer l’effet d’un programme, en particulier des procédures qui permettent de prendre en compte justement les différences qui peuvent exister entre les groupes en pré-programme.</p>
<p><strong>Cas particuliers</strong></p>
<p>Certaines situations peuvent rendre la comparaison de moyennes non pertinente. C’est par exemple le cas lorsque l’un des deux groupes (voire les deux) présentent des données aberrantes ou très extrêmes, en particulier en présence de petits échantillons. L’utilisation des moyennes dans ce cas pourrait ne pas être pertinente car ces moyennes ne refléteraient alors pas correctement les tendances centrales (et donc les groupes associés). Dans ces cas là, mieux vaut observer les médianes de chaque groupe et chercher à voir si les distributions sont en décalage ou non.</p>
<div id="cas-de-deux-groupes-de-données-dépendants-données-appariées" class="section level4">
<h4>
<span class="header-section-number">4.3.2.1</span> Cas de deux groupes de données dépendants (données appariées)<a class="anchor" aria-label="anchor" href="#cas-de-deux-groupes-de-donn%C3%A9es-d%C3%A9pendants-donn%C3%A9es-appari%C3%A9es"><i class="fas fa-link"></i></a>
</h4>
<p><strong><span class="math inline">\(d_{z}\)</span> et <span class="math inline">\(d_{av}\)</span> de Cohen</strong></p>
<p>Le calcul classique pour obtenir la taille d’effet désignant l’écart entre deux groupes de données dépendantes est celui du <span class="math inline">\(d_{z}\)</span> <span class="citation">(Lakens, <a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>, qui est montré ci-dessous :</p>
<p><span class="math display">\[d_{z} = \frac{\overline{X} _{diff}}{\hat{\sigma}_{diff}},\]</span></p>
<p><span class="math inline">\(\overline{X}_{diff}\)</span> désignant la moyenne des différences relatives à chaque pair de valeurs obtenues dans les deux conditions comparées, et <span class="math inline">\(\hat{\sigma}_{diff}\)</span> désignant l’écart-type de ces différences. Dans R, le <span class="math inline">\(d_{z}\)</span> peut être obtenu à nouveau avec la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d()</a></code> du package <code>effectsize</code>. Pour illustrer cela, nous allons à nouveau utiliser le jeu de données <code>Blink2</code> crée plus haut pour les exemples de <em>raincloud plots</em>.</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d</a></span><span class="op">(</span></span>
<span>  <span class="va">Blink_rate</span> <span class="op">~</span> <span class="va">Condition</span>, </span>
<span>  data <span class="op">=</span> <span class="va">Blink2</span>, </span>
<span>  paired <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Cohen's d |       95% CI
## ------------------------
## 2.81      | [1.51, 4.09]</code></pre>
<p>Toutefois, d’après Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>, il peut être intéressant de rapporter plutôt un indice de taille d’effet qui ne serait pas influencé par le fait que les données des deux groupes à comparer soient corrélées (car dépendantes), notamment en vue de rendre comparable cette taille d’effet à celles obtenues dans le cadre d’études de type <em>between-subject design</em>, pour plus facilement conduire des méta-analyses par la suite par exemple. La recommandation de Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span> serait alors d’utiliser l’indice <span class="math inline">\(d_{av}\)</span>, dont le calcul serait le suivant :</p>
<p><span class="math display">\[d_{av} = \frac{\overline{X} _{diff}}{\sqrt{\frac{\hat{\sigma}_{1}^2 + \hat{\sigma}_{2}^2} {2}}}\]</span></p>
<p>Ce calcul reviendrait donc à diviser la moyenne des différences par l’écart-type moyen relatif aux deux groupes de données. Pour obtenir <span class="math inline">\(d_{av}\)</span>, il est possible de repartir de la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d()</a></code> et de sa configuration pour des groupes indépendants, mais en indiquant <code>pooled_sd = FALSE</code> dans la fonction, comme ci-dessous :</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">cohens_d</a></span><span class="op">(</span></span>
<span>  <span class="va">Blink_rate</span> <span class="op">~</span> <span class="va">Condition</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Blink2</span>, </span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Cohen's d |       95% CI
## ------------------------
## 1.53      | [0.58, 2.44]
## 
## - Estimated using un-pooled SD.</code></pre>
<p>En effet, que l’on fasse la moyenne des différences (ce qui serait attendu pour le présent calcul) ou la différence entre deux moyennes (ce qui est finalement fait par la fonction telle que configurée ci-dessus), cela ne change rien avec des données appariées. Le numérateur <span class="math inline">\(\overline{X} _{diff}\)</span> reste donc correctement calculé même avec cette configuration de fonction qui est faite initialement pour des groupes indépendants. Le fait d’indiquer <code>pooled_sd = FALSE</code> change le calcul du dénominateur que nous avions rencontré initialement pour le calcul de <span class="math inline">\(d_{s}\)</span>, cela pour obtenir le calcul attendu pour le <span class="math inline">\(d_{av}\)</span>.</p>
<p><strong><span class="math inline">\(g_{av}\)</span> de Hedges</strong></p>
<p>Comme dans le cas de l’étude de groupes indépendants, <span class="math inline">\(d_{av}\)</span> et ses dérivés sont biaisés. Il peut donc être à nouveau préférable de calculer le <span class="math inline">\(g_{av}\)</span> de Hedges avec la fonction <code><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g()</a></code> configurée comme ceci :</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html">hedges_g</a></span><span class="op">(</span></span>
<span>  <span class="va">Blink_rate</span> <span class="op">~</span> <span class="va">Condition</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Blink2</span>, </span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  pooled_sd <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Hedges' g |       95% CI
## ------------------------
## 1.47      | [0.56, 2.35]
## 
## - Estimated using un-pooled SD.</code></pre>
<p>Toutefois, comme le rappelle Lakens <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-lakensCalculatingReportingEffect2013" role="doc-biblioref">2013</a>)</span>, le <span class="math inline">\(g_{av}\)</span> de Hedges ne serait pas complètement non biaisé.</p>
<p><strong>Cas particuliers</strong></p>
<p>Lorsque la présence de valeurs aberrantes peut fausser le calcul de la taille d’effet que l’on cherche à caractériser dans la population étudiée, une première idée pourrait être ici de faire la différence des médianes des deux groupes. Toutefois, comme le rappellent Weissegerber et al. <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-weissgerberBarLineGraphs2015" role="doc-biblioref">2015</a>)</span>, cette approche n’est mathématiquement pas correcte dans le cas présent. La bonne méthode est de calculer la médiane des différences. Le code ci-dessous présente donc le calcul de la médiane des différences, ici à partir du jeu de données <code>Blink</code>. La visualisation graphique correspondante pourrait être alors un <em>raincloud plot</em> pour une seule variable, celle des différences entre les deux conditions. Le code pour ce type de graphiques a été vu au chapitre précédent.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Configuration du jeu de données</span></span>
<span><span class="va">Blink2</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">Blink</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Difference <span class="op">=</span> <span class="va">Straight</span> <span class="op">-</span> <span class="va">Oscillating</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Straight</span>, <span class="va">Oscillating</span>, <span class="va">Difference</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"Condition"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"Blink_rate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Condition <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">Condition</span>, </span>
<span>                                 <span class="st">"Straight"</span>, </span>
<span>                                 <span class="st">"Oscillating"</span>, </span>
<span>                                 <span class="st">"Difference"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcul de la médiane des différences</span></span>
<span> <span class="va">Blink</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Difference <span class="op">=</span> <span class="va">Straight</span> <span class="op">-</span> <span class="va">Oscillating</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>median_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Difference</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   median_diff
## 1           7</code></pre>
</div>
</div>
<div id="comparaison-de-trois-groupes-de-données-et-plus" class="section level3">
<h3>
<span class="header-section-number">4.3.3</span> Comparaison de trois groupes de données et plus<a class="anchor" aria-label="anchor" href="#comparaison-de-trois-groupes-de-donn%C3%A9es-et-plus"><i class="fas fa-link"></i></a>
</h3>
<p>…</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="analyses-univari%C3%A9es.html"><span class="header-section-number">3</span> Analyses univariées</a></div>
<div class="next"><a href="r%C3%A9gressions.html"><span class="header-section-number">5</span> Régressions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analyses-bivari%C3%A9es"><span class="header-section-number">4</span> Analyses bivariées</a></li>
<li>
<a class="nav-link" href="#relation-entre-deux-variables-quantitatives"><span class="header-section-number">4.1</span> Relation entre deux variables quantitatives</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%C3%A9tudier-graphiquement-la-relation"><span class="header-section-number">4.1.1</span> Étudier graphiquement la relation</a></li>
<li><a class="nav-link" href="#%C3%A9tudier-num%C3%A9riquement-la-relation"><span class="header-section-number">4.1.2</span> Étudier numériquement la relation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#relation-entre-deux-variables-qualitatives"><span class="header-section-number">4.2</span> Relation entre deux variables qualitatives</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%C3%A9tudier-graphiquement-la-relation-1"><span class="header-section-number">4.2.1</span> Étudier graphiquement la relation</a></li>
<li><a class="nav-link" href="#%C3%A9tudier-num%C3%A9riquement-la-relation-1"><span class="header-section-number">4.2.2</span> Étudier numériquement la relation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#relation-entre-une-variable-quantitative-et-une-variable-qualitative"><span class="header-section-number">4.3</span> Relation entre une variable quantitative et une variable qualitative</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#comparaison-de-deux-groupes-de-donn%C3%A9es"><span class="header-section-number">4.3.1</span> Comparaison de deux groupes de données</a></li>
<li><a class="nav-link" href="#cas-de-deux-groupes-de-donn%C3%A9es-ind%C3%A9pendants-donn%C3%A9es-non-appari%C3%A9es"><span class="header-section-number">4.3.2</span> Cas de deux groupes de données indépendants (données non appariées)</a></li>
<li><a class="nav-link" href="#comparaison-de-trois-groupes-de-donn%C3%A9es-et-plus"><span class="header-section-number">4.3.3</span> Comparaison de trois groupes de données et plus</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/pydemull/Analyser-des-donnees-avec-R/blob/master/04-Bivariate_analyses.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/pydemull/Analyser-des-donnees-avec-R/edit/master/04-Bivariate_analyses.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Analyser des données avec R</strong>" was written by Pierre-Yves de Müllenheim. It was last built on 2022-08-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
